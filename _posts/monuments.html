---
layout: post
title:  "abstracting classics"
type: "experiment"
date:   2014-01-10 13:47:00
color: "purple"
---
<!-- Post Content -->
<style>
	canvas:hover {
		cursor: cell;
	}

	#mycursor {
		position: absolute;
		background-color: blue;
		color:white;
		font-size: .9em;
		padding: 0em 1em;
		display: none;
	}
</style>

<div id="mycursor" class="tk-inconsolata">click to clarify</div>


<script type="text/javascript" src="{{ root_path }}/js/paper-full.js"></script>

<canvas id="myCanvas1" width="671" height="600"></canvas>
<img style="display:none" src="{{ root_path }}/img/monuments/hill.jpg" id="hill"/>
<div>Clicks: <span class="hill">0</span></div>

<canvas id="myCanvas3" width="671" height="600"></canvas>
<img style="display:none" src="{{ root_path }}/img/monuments/jefferson2.jpg" id="jefferson2"/>

<canvas id="myCanvas5" width="671" height="600"></canvas>
<img style="display:none" src="{{ root_path }}/img/monuments/lincoln2.jpg" id="lincoln2"/>

<canvas id="myCanvas6" width="671" height="600"></canvas>
<img style="display:none" src="{{ root_path }}/img/monuments/whitehouse.jpg" id="whitehouse"/>

<canvas id="myCanvas8" width="671" height="600"></canvas>
<img style="display:none" src="{{ root_path }}/img/monuments/monument2.jpg" id="monument2"/>

<canvas id="myCanvas9" width="671" height="600"></canvas>
<img style="display:none" src="{{ root_path }}/img/monuments/panda.jpg" id="panda"/>




<script type="text/javascript">

window.onload = function() {


var setupCanvas = function (canvasName, rasterName) {
	var myPaper = new paper.PaperScope();
	var canvas = document.getElementById(canvasName);
	// Create an empty project and a view for the canvas:
	paper.setup(canvas);
	paper.project.activeLayer.removeChildren();
		
	var size = 2,
		rastRatio,
		paths = [];

	var clarify = function(rasterName, size, rastRatio) {
		paths = [];

		var raster =  new paper.Raster(rasterName),
			w,
			h,
			gridSize;

		// Hide the raster:
		raster.visible = false;

		// As the web is asynchronous, we need to wait for the raster to load
		// before we can perform any operation on its pixels.
		raster.on('load', function() {
			// Since the example image we're using is much too large,
			// and therefore has way too many pixels, lets downsize it to
			// 40 pixels wide and 30 pixels high:

			//the max width is always 671


			if ( raster.height > raster.width ) {
				rastRatio = raster.width/raster.height;
				orientation = 'portrait';
				h = size,
				w = h*rastRatio,
				gridSize = (canvas.height)/h;
			} else {
			    rastRatio = raster.height/raster.width;
			    orientation = 'landscape';
			   	w = size,
				h = w*rastRatio,
				gridSize = (canvas.width)/w;
			}	

			if ( gridSize <= 5 ) {
				return;
			} else {
				paper.project.activeLayer.removeChildren();
			}

			raster.size = new paper.Size(w, h);

			var x1 = 0,
				y1 = 0,
				x2 = 0 + gridSize+1,
				y2 = 0 + gridSize;


			for (var y = 0; y < raster.height; y++) {
				for(var x = 0; x < raster.width; x++) {
					// Get the color of the pixel:
					var color = raster.getPixel(x, y);


					// Create a circle shaped path:
					var square = new paper.Rectangle(new paper.Point(x1, y1), new paper.Point(x2, y2));
					var path = new paper.Path.Rectangle(square);

					// Set the fill color of the path to the color
					// of the pixel:
					path.fillColor = color;

					//make some changes to the point location
					x1 = x1 + gridSize;

					x2 = x2 + gridSize;
				}
				x1= 0;
				x2 = x1 + gridSize+1;
				y1 = y1 + gridSize;
				y2 = y2 + gridSize;
			}

			// Move the active layer to the center of the view, so all 
			// the created paths in it appear centered.
			paper.project.activeLayer.position = paper.view.center;

		});

	};

	paper.tool.onMouseDown = function(event) {
		size = size*1.25;
		clarify(rasterName, size, rastRatio);
		$('.hill').text('1');
	};

	//draw things!
	clarify(rasterName, size, rastRatio);
	paper.view.draw();
}

function initialDraw() {
	setupCanvas('myCanvas1', 'hill');
	setupCanvas('myCanvas3', 'jefferson2');
	setupCanvas('myCanvas5', 'lincoln2');
	setupCanvas('myCanvas6', 'whitehouse');
	setupCanvas('myCanvas8', 'monument2');
	setupCanvas('myCanvas9', 'panda');
};

initialDraw();

var cursor = document.getElementById("mycursor");
$('canvas').hover(function(){
	$('canvas').mousemove(function(e){
		cursor.style.display = 'block';
		cursor.style.top = e.pageY*1 + 5 + "px";
	    cursor.style.left = e.pageX*1 + 5 + "px";
	});	
},function(){
	cursor.style.display = 'none';
});


}; // end window.onload
</script>